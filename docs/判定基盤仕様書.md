# 判定基盤仕様書

## 1. 目的
- 自動判定課題レッスンのコードを安全に実行し、即時判定する。

## 2. 対応言語
- PHP
- JavaScript
- Python

## 3. 判定設定
- `section_judge_configs.config` に JSON で保持。
- 必須項目:
  - `allowed_languages`
  - `cases[{stdin, expected_stdout}]`
- 任意項目:
  - `time_limit_sec`
  - `memory_limit_mb`

## 4. 実行方式
- `POST /api/sections/{id}/judge-runs` で `judge_runs` 作成。
- `RunJudgeJob` を同期実行し `JudgeRunnerService` が Docker を起動。
- 実行オプション:
  - `--network none`
  - `--memory 256m`
  - `--cpus 0.5`
  - `--pids-limit 64`
  - `--read-only`

## 5. 判定ルール
- 各ケースで標準出力を比較（改行はCRLF→LF正規化後に比較）。
- 全ケース一致で `passed=true`。
- 失敗時は `failed`、タイムアウトは `timeout`、実行例外は `error`。

## 6. 提出連携
- 自動判定課題の提出は `passed=true` かつ「最新の判定OKラン」だけ許可。
