# 社内教育システム 要件定義（最終版）

- 対象：インターン / 新人教育（社内利用）
- 技術：Laravel（API） + React（SPA）
- 開発環境：Docker（ローカル）、DB：MySQL
- ファイル保管：本番 S3 想定 / 開発 minio

---

## 1. 目的・ゴール

### 1.1 目的

- 受講者が **コース → レッスン** の教材を任意順で学習し、提出・進捗管理できる
- レッスンには2種類の提出方式を持たせる
  - **自動判定課題レッスン**：コード提出（実行ボタンで即時判定）
  - **Webアプリ講座レッスン**：GitHub URL 提出（レビューで合否）
- 管理者 / レビュー担当が **進捗確認・レビューコメント・承認（合格/差戻し）** を行える
- 教材管理は「**PDF添付中心**」で運用コストを下げる（画面内表示必須）

### 1.2 成功条件（完了の定義）

- 受講者がレッスンを提出し、**管理者またはレビュー担当がレビューコメント（必須）を残して承認**した状態を「合格」とする
- 進捗（完了率等）は **「合格」** を完了として集計する

---

## 2. 用語・概念整理（ドメイン定義）

| 用語       | 定義                                                                  |
| ---------- | --------------------------------------------------------------------- |
| コース     | 学習コース/まとまり（例：アルゴリズム、Laravel基礎など）            |
| レッスン | コース配下の学習単位。教材（PDF）と提出（コード or GitHub URL）を持つ |
| 受講者     | 学習を行い提出する一般ユーザー                                        |
| 管理者     | 教材管理・ユーザー管理・レビュー/承認ができる                         |
| レビュー   | 進捗確認・レビュー/承認ができる（教材管理は不可）                     |
| ラベル     | ユーザーを分類するタグ。ラベル名 + 対象期間（From-To または永久）     |
| 提出       | 受講者がレッスン単位で行う入力（理解度+コメント+成果物）            |
| レビュー   | 管理者/レビューが行う審査（レビューコメント必須、承認 or 差戻し）     |
| ヒント     | レッスンに紐づく補助情報（最大3つ）。段階解放型（ヒント1→2→3）    |

---

## 3. 役割（ロール）と権限

### 3.1 ロール

- 受講者（User）
- 管理者（Admin）
- レビュー（Reviewer）

### 3.2 権限マトリクス

| 機能                                                      | 受講者 |            レビュー |     管理者 |
| --------------------------------------------------------- | -----: | ------------------: | ---------: |
| ログイン/ログアウト、パスワード再設定                     |     ✅ |                  ✅ |         ✅ |
| マイページ（ユーザー名・パスワード変更）                  |     ✅ |                  ✅ |         ✅ |
| コース/レッスン閲覧（表示中のみ）                       |     ✅ | ✅（閲覧/確認目的） |         ✅ |
| レッスン提出（理解度/コメント/コード/URL/追加テキスト） |     ✅ |                  ❌ |         ❌ |
| 自分の進捗ダッシュボード                                  |     ✅ |   ✅（全体/担当分） | ✅（全体） |
| ユーザー一覧/進捗閲覧                                     |     ❌ |                  ✅ |         ✅ |
| レビューコメント（必須）/承認・差戻し                     |     ❌ |                  ✅ |         ✅ |
| コース/レッスンCRUD、表示順変更、非表示、ヒント設定     |     ❌ |                  ❌ |         ✅ |
| ラベルCRUD、ユーザーへのラベル付与                        |     ❌ |      ❌（閲覧のみ） |         ✅ |
| 招待メール送信、ユーザー無効化                            |     ❌ |                  ❌ |         ✅ |

---

## 4. 機能要件

### 4.1 認証・アカウント

#### 4.1.1 ユーザー登録（招待制）

- 管理者がユーザーを招待（メールアドレス登録 → 招待メール送信）
- 受講者は招待リンクから初回設定
  - ユーザー名（表示名）設定
  - パスワード設定
- メールドメイン制限は行わない

#### 4.1.2 ログイン

- メールアドレス + パスワード
- ログイン状態の永続化（Remember）

#### 4.1.3 パスワード再設定

- メール経由で再設定

#### 4.1.4 マイページ

- ユーザー名変更
- パスワード変更

---

### 4.2 学習（受講者機能）

#### 4.2.1 コース閲覧

- コース/レッスンは表示設定がONのもののみ表示
- 任意順で受講可能
- 表示順は管理者設定に従う

#### 4.2.2 レッスン詳細

- PDF画面内表示（最大5ファイル）
- ヒント表示（未設定ならボタン非表示）
- 提出状況表示
- レビューコメント履歴表示

#### 4.2.3 ダッシュボード

- 全体進捗（合格ベース）
- コース別進捗
- レビュー待ち/差戻し件数
- 最近の活動ログ

---

### 4.3 レッスン提出

#### 4.3.1 提出種別

- 自動判定課題（コード判定）
- Webアプリ講座（GitHub URL）

#### 4.3.2 提出項目

- 理解度（1〜10、必須）
- コメント（任意）
- 成果物
  - 自動判定課題：コード（判定OKコードが自動保存）
  - Webアプリ：GitHub URL（必須）
- Webアプリのみ：追加テキスト提出（有効化時）

#### 4.3.3 理解度補助テキスト

| 値 | 補助テキスト                |
| -: | --------------------------- |
|  1 | 全く理解できていない        |
|  2 | ほとんど理解できていない    |
|  3 | 断片的に理解している        |
|  4 | うっすら理解している        |
|  5 | 半分くらい理解している      |
|  6 | 大枠は理解している          |
|  7 | 概ね理解している            |
|  8 | かなり理解している          |
|  9 | 自信を持って実装/説明できる |
| 10 | 人に教えられるレベル        |

#### 4.3.4 ステータス

- 未提出
- レビュー待ち
- やり直し
- 合格

---

### 4.4 自動判定課題レッスン

#### 対応言語

- PHP
- JavaScript
- Python

#### 判定仕様

- 実行ボタンで即時判定
- 全テストケース一致でOK
- 判定OKコードが提出時に自動添付
- サンドボックス実行（ネットワーク遮断・制限あり）

#### 判定データ

- 管理者が専用ブロックを記述
- システムが抽出し自動判定

---

### 4.5 管理者機能

#### コース管理

- CRUD
- 表示/非表示
- 表示順変更

#### レッスン管理

- CRUD（編集必須）
- 表示/非表示
- 表示順変更
- 種別設定
- PDF最大5添付（S3/minio）
- 判定用コードブロック（自動判定課題レッスンのみ）
- 追加テキスト提出有効化（Webアプリのみ）
- ヒント最大3登録

#### ユーザー管理

- 招待
- 有効/無効
- 進捗確認

#### ラベル管理

- ラベル作成（名称 + 期間 or 永久）
- ユーザー付与
- フィルタ・集計

---

### 4.6 Webアプリ講座：追加テキスト提出

- レッスン設定で有効化トグル
- 有効時のみ入力欄表示
- ラベル名変更可能（例：使用機能/ライブラリ）
- 必須入力

---

### 4.7 ヒント機能

- 最大3つ登録可能
- ヒント未設定ならボタン非表示
- 段階解放型
  - ヒント1開示後 → ヒント2有効
  - ヒント2開示後 → ヒント3有効
- 正解に近づく順に具体化

---

## 5. 画面一覧

### 受講者

- ログイン
- ダッシュボード
- コース/レッスン（サイドバー連動）
- 提出画面
- マイページ

### 管理者

- 管理ダッシュボード
- コース/レッスン管理
- ユーザー管理
- ラベル管理
- レビュー画面

### レビュー

- レビュー待ち一覧
- レビュー実施画面

---

## 6. 非機能要件

- 招待制認証
- 権限制御
- PDF認可配信
- コードサンドボックス実行
- S3/minio管理
- MySQLバックアップ
- ログ保持（推奨）

---

## 7. スコープ

本要件はフェーズ3相当まで全て含む。

---
